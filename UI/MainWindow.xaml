<!--
Pixeval - A Strong, Fast and Flexible Pixiv Client
Copyright (C) 2019 Dylech30th

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <https://www.gnu.org/licenses/>.
-->

<!-- ReSharper disable Xaml.RedundantResource -->
<Window x:Class="Pixeval.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:valueConverters="clr-namespace:Pixeval.Objects.ValueConverters"
        xmlns:controls="clr-namespace:WpfToolkit.Controls;assembly=VirtualizingWrapPanel"
        xmlns:objects="clr-namespace:Pixeval.Objects"
        xmlns:viewModel="clr-namespace:Pixeval.Data.ViewModel"
        xmlns:userControls="clr-namespace:Pixeval.UI.UserControls"
        xmlns:system="clr-namespace:System;assembly=System.Runtime"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontFamily="Microsoft YaHei UI Light"
        mc:Ignorable="d"
        Initialized="MainWindow_OnInitialized" MouseDown="MainWindow_OnMouseDown"
        Deactivated="MainWindow_OnDeactivated"
        Title="Pixeval | A Fast, Strong and Flexible Pixiv Client" Height="900" Width="1600"
        Icon="/Resources/pxlogo.ico">
    <Window.Resources>
        <CubicEase x:Key="CubicEase" EasingMode="EaseOut" />
        <valueConverters:VisibleIfTrueConverter x:Key="VisibleIfTrueConverter" />
        <valueConverters:VisibleIfFalseConverter x:Key="VisibleIfFalseConverter" />
        <valueConverters:WidthMinus45PxConverter x:Key="WidthMinus45PxConverter" />
        <valueConverters:IllustSubscriptConverter x:Key="IllustSubscriptConverter" />
        <valueConverters:IllustTagConverter x:Key="IllustTagConverter" />
        <valueConverters:DateTimeOffsetConverter x:Key="DateTimeOffsetConverter" />
        <valueConverters:ControlCenterConverter x:Key="ControlCenterConverter" />
        <Storyboard x:Key="UserBrowserOpacityIncreaseAnimation" TargetName="UserBrowserPageScrollViewer"
                    TargetProperty="(ScrollViewer.Opacity)">
            <DoubleAnimation From="0" To="1" Duration="00:00:00.3" EasingFunction="{StaticResource CubicEase}" />
        </Storyboard>
        <Storyboard x:Key="UserBrowserScaleXIncreaseAnimation" TargetName="UserBrowserPageScrollViewer"
                    TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleX)">
            <DoubleAnimation From="0" To="1" Duration="00:00:00.3" EasingFunction="{StaticResource CubicEase}" />
        </Storyboard>
        <Storyboard x:Key="UserBrowserScaleYIncreaseAnimation" TargetName="UserBrowserPageScrollViewer"
                    TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleY)">
            <DoubleAnimation From="0" To="1" Duration="00:00:00.3" EasingFunction="{StaticResource CubicEase}" />
        </Storyboard>
        <Storyboard x:Key="ContentContainerOpacityIncreaseAnimation" TargetName="ContentContainer"
                    TargetProperty="(Grid.Opacity)">
            <DoubleAnimation From="1" To="0" Duration="00:00:00.3" EasingFunction="{StaticResource CubicEase}" />
        </Storyboard>
        <Storyboard x:Key="ContentContainerScaleXIncreaseAnimation" TargetName="ContentContainer"
                    TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleX)">
            <DoubleAnimation From="1" To="0" Duration="00:00:00.3" EasingFunction="{StaticResource CubicEase}" />
        </Storyboard>
        <Storyboard x:Key="ContentContainerScaleYIncreaseAnimation" TargetName="ContentContainer"
                    TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleY)">
            <DoubleAnimation From="1" To="0" Duration="00:00:00.3" EasingFunction="{StaticResource CubicEase}" />
        </Storyboard>
        <Style TargetType="Image" x:Key="ReleaseImageStyle">
            <Style.Triggers>
                <Trigger Property="IsVisible" Value="False">
                    <Setter Property="Source" Value="{x:Null}" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <DataTemplate x:Key="IllustrationTemplate" DataType="viewModel:Illustration">
            <Grid Width="280" Height="200" x:Name="IllustrationContainer" Cursor="Hand"
                  MouseLeftButtonDown="IllustrationContainer_OnMouseLeftButtonDown" ToolTip="{Binding Path=Id}"
                  ClipToBounds="True">
                <Grid.ContextMenu>
                    <ContextMenu>
                        <MenuItem x:Name="DownloadNowMenuItem" Header="下载该作品" Click="DownloadNowMenuItem_OnClick" />
                        <MenuItem x:Name="DownloadAllNowMenuItem" Header="下载当前列表中的所有作品"
                                  Click="DownloadAllNowMenuItem_OnClick" />
                        <MenuItem x:Name="AddToDownloadListMenuItem" Header="添加到下载列表"
                                  Click="AddToDownloadListMenuItem_OnClick" />
                        <MenuItem x:Name="AddAllToDownloadListMenuItem" Header="将当前列表的所有作品添加到下载列表"
                                  Click="AddAllToDownloadListMenuItem_OnClick" />
                    </ContextMenu>
                </Grid.ContextMenu>
                <Grid.Triggers>
                    <EventTrigger RoutedEvent="Grid.MouseEnter">
                        <BeginStoryboard>
                            <Storyboard TargetName="IllustrationThumbnailScaleTransform"
                                        TargetProperty="(ScaleTransform.ScaleX)">
                                <DoubleAnimation From="1" To="1.2" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="IllustrationThumbnailScaleTransform"
                                        TargetProperty="(ScaleTransform.ScaleY)">
                                <DoubleAnimation From="1" To="1.2" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="IllustrationThumbnailBlurEffect"
                                        TargetProperty="(BlurEffect.Radius)">
                                <DoubleAnimation From="1" To="80" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="IllustrationMask" TargetProperty="(Grid.Opacity)">
                                <DoubleAnimation From="0" To="0.4" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="IllustrationTitle" TargetProperty="(TextBlock.Opacity)">
                                <DoubleAnimation From="0" To="1" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                    <EventTrigger RoutedEvent="Grid.MouseLeave">
                        <BeginStoryboard>
                            <Storyboard TargetName="IllustrationThumbnailScaleTransform"
                                        TargetProperty="(ScaleTransform.ScaleX)">
                                <DoubleAnimation From="1.2" To="1" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="IllustrationThumbnailScaleTransform"
                                        TargetProperty="(ScaleTransform.ScaleY)">
                                <DoubleAnimation From="1.2" To="1" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="IllustrationThumbnailBlurEffect"
                                        TargetProperty="(BlurEffect.Radius)">
                                <DoubleAnimation From="80" To="1" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="IllustrationMask" TargetProperty="(Grid.Opacity)">
                                <DoubleAnimation From="0.4" To="0" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="IllustrationTitle" TargetProperty="(TextBlock.Opacity)">
                                <DoubleAnimation From="1" To="0" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                </Grid.Triggers>
                <Image x:Name="Thumbnail" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                       Style="{StaticResource ReleaseImageStyle}"
                       Stretch="UniformToFill" Loaded="Thumbnail_OnLoaded">
                    <Image.Effect>
                        <BlurEffect x:Name="IllustrationThumbnailBlurEffect" KernelType="Gaussian" Radius="1" />
                    </Image.Effect>
                    <Image.RenderTransform>
                        <ScaleTransform x:Name="IllustrationThumbnailScaleTransform" />
                    </Image.RenderTransform>
                </Image>
                <Grid x:Name="IllustrationMask" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                      Background="Black" Opacity="0"
                      MaxWidth="{Binding ElementName=IllustrationContainer, Path=ActualWidth}" />
                <TextBlock x:Name="IllustrationTitle" Margin="80 0 80 0" HorizontalAlignment="Center"
                           VerticalAlignment="Center" FontSize="15" TextWrapping="Wrap" TextAlignment="Center"
                           Text="{Binding Title}" FontFamily="YouYuan" Opacity="0"
                           Foreground="#FFB6B6B6" />
                <Grid>
                    <Button x:Name="FavorButton" Click="FavorButton_OnClick" Height="30" Width="30"
                            VerticalAlignment="Top" HorizontalAlignment="Left" Margin="15 10 15 0"
                            Style="{DynamicResource MaterialDesignToolButton}"
                            Visibility="{Binding Path=IsLiked, Converter={StaticResource VisibleIfFalseConverter}}">
                        <Viewbox Width="24" Height="24">
                            <Canvas Width="24" Height="24">
                                <Path
                                    Data="M12.1,18.55L12,18.65L11.89,18.55C7.14,14.24 4,11.39 4,8.5C4,6.5 5.5,5 7.5,5C9.04,5 10.54,6 11.07,7.36H12.93C13.46,6 14.96,5 16.5,5C18.5,5 20,6.5 20,8.5C20,11.39 16.86,14.24 12.1,18.55M16.5,3C14.76,3 13.09,3.81 12,5.08C10.91,3.81 9.24,3 7.5,3C4.42,3 2,5.41 2,8.5C2,12.27 5.4,15.36 10.55,20.03L12,21.35L13.45,20.03C18.6,15.36 22,12.27 22,8.5C22,5.41 19.58,3 16.5,3Z"
                                    Fill="Gray" />
                            </Canvas>
                        </Viewbox>
                    </Button>
                    <Button x:Name="DisfavorButton" Click="DisfavorButton_OnClick" Height="30"
                            Width="30" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="15 10 15 0"
                            Style="{DynamicResource MaterialDesignToolButton}"
                            Visibility="{Binding Path=IsLiked, Converter={StaticResource VisibleIfTrueConverter}}">
                        <Viewbox Width="24" Height="24">
                            <Canvas Width="24" Height="24">
                                <Path
                                    Data="M12,21.35L10.55,20.03C5.4,15.36 2,12.27 2,8.5C2,5.41 4.42,3 7.5,3C9.24,3 10.91,3.81 12,5.08C13.09,3.81 14.76,3 16.5,3C19.58,3 22,5.41 22,8.5C22,12.27 18.6,15.36 13.45,20.03L12,21.35Z"
                                    Fill="Crimson" />
                            </Canvas>
                        </Viewbox>
                    </Button>
                </Grid>
                <Grid VerticalAlignment="Top" HorizontalAlignment="Right" Width="30" Height="30"
                      Margin="0 15 15 0"
                      Visibility="{Binding Converter={StaticResource IllustSubscriptConverter}}">
                    <Viewbox Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center"
                             Visibility="{Binding IsUgoira, Converter={StaticResource VisibleIfTrueConverter}}"
                             ToolTip="这是一个GIF动图">
                        <Canvas Width="24" Height="24">
                            <Path
                                Data="M11,8H13V16H11V8M7.67,8H4.33C3.53,8 3,8.67 3,9.33V14.67C3,15.33 3.53,16 4.33,16H7.67C8.47,16 9,15.33 9,14.67V12H7V14H5V10H9V9.33C9,8.67 8.47,8 7.67,8M21,10V8H15V16H17V14H19.5V12H17V10H21Z"
                                Fill="Gray" />
                        </Canvas>
                    </Viewbox>
                    <Viewbox Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center"
                             Visibility="{Binding IsManga, Converter={StaticResource VisibleIfTrueConverter}}"
                             ToolTip="这是一个图集">
                        <Canvas Width="24" Height="24">
                            <Path
                                Data="M22,16V4A2,2 0 0,0 20,2H8A2,2 0 0,0 6,4V16A2,2 0 0,0 8,18H20A2,2 0 0,0 22,16M11,12L13.03,14.71L16,11L20,16H8M2,6V20A2,2 0 0,0 4,22H18V20H4V6"
                                Fill="Gray" />
                        </Canvas>
                    </Viewbox>
                </Grid>
            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="SpotlightDataTemplate" DataType="viewModel:SpotlightArticle">
            <Grid x:Name="SpotlightContainer" Height="300" HorizontalAlignment="Stretch" Cursor="Hand"
                  MouseLeftButtonDown="SpotlightContainer_OnMouseLeftButtonDown"
                  Width="{Binding ElementName=SpotlightListView, Path=ActualWidth, Converter={StaticResource WidthMinus45PxConverter}}">
                <Grid.ContextMenu>
                    <ContextMenu>
                        <MenuItem x:Name="DownloadSpotlightItem" Header="下载特辑" Click="DownloadSpotlightItem_OnClick" />
                    </ContextMenu>
                </Grid.ContextMenu>
                <Grid.Triggers>
                    <EventTrigger RoutedEvent="ListViewItem.MouseEnter">
                        <BeginStoryboard>
                            <Storyboard TargetName="SpotlightScaleTransform" TargetProperty="(ScaleTransform.ScaleX)">
                                <DoubleAnimation From="1" To="1.2" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="SpotlightScaleTransform" TargetProperty="(ScaleTransform.ScaleY)">
                                <DoubleAnimation From="1" To="1.2" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="SpotlightBlurEffect" TargetProperty="(BlurEffect.Radius)">
                                <DoubleAnimation From="1" To="80" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="SpotlightMask" TargetProperty="(Grid.Opacity)">
                                <DoubleAnimation From="0" To="0.4" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="SpotlightTitle" TargetProperty="(TextBlock.Opacity)">
                                <DoubleAnimation From="0" To="1" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                    <EventTrigger RoutedEvent="ListViewItem.MouseLeave">
                        <BeginStoryboard>
                            <Storyboard TargetName="SpotlightScaleTransform" TargetProperty="(ScaleTransform.ScaleX)">
                                <DoubleAnimation From="1.2" To="1" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="SpotlightScaleTransform" TargetProperty="(ScaleTransform.ScaleY)">
                                <DoubleAnimation From="1.2" To="1" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="SpotlightBlurEffect" TargetProperty="(BlurEffect.Radius)">
                                <DoubleAnimation From="80" To="1" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="SpotlightMask" TargetProperty="(Grid.Opacity)">
                                <DoubleAnimation From="0.4" To="0" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetName="SpotlightTitle" TargetProperty="(TextBlock.Opacity)">
                                <DoubleAnimation From="1" To="0" Duration="00:00:00.3"
                                                 EasingFunction="{StaticResource CubicEase}" />
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                </Grid.Triggers>
                <Image x:Name="SpotlightThumbnail" Stretch="UniformToFill" HorizontalAlignment="Stretch"
                       VerticalAlignment="Center" RenderTransformOrigin="0.5 0.5"
                       Style="{StaticResource ReleaseImageStyle}"
                       MaxWidth="{Binding ElementName=SpotlightListView, Path=ActualWidth}"
                       Loaded="SpotlightThumbnail_OnLoaded">
                    <Image.Effect>
                        <BlurEffect x:Name="SpotlightBlurEffect" KernelType="Gaussian" Radius="1" />
                    </Image.Effect>
                    <Image.RenderTransform>
                        <ScaleTransform x:Name="SpotlightScaleTransform" />
                    </Image.RenderTransform>
                </Image>
                <Grid x:Name="SpotlightMask" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                      Background="Black" Opacity="0"
                      MaxWidth="{Binding ElementName=SpotlightListView, Path=ActualWidth}" />
                <TextBlock x:Name="SpotlightTitle" Margin="80 0 80 0" HorizontalAlignment="Center"
                           VerticalAlignment="Center" FontSize="55" TextWrapping="Wrap" TextAlignment="Center"
                           Text="{Binding Title}" FontFamily="YouYuan" Opacity="0" LineHeight="80"
                           Foreground="#FFB6B6B6" />
            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="UserPreviewTemplate" DataType="viewModel:User">
            <materialDesign:TransitioningContent>
                <materialDesign:TransitioningContent.OpeningEffects>
                    <materialDesign:TransitionEffect Kind="FadeIn" />
                </materialDesign:TransitioningContent.OpeningEffects>
                <materialDesign:Card x:Name="UserPrevItem" Cursor="Hand" Background="#FAFAFC"
                                     Width="{Binding ElementName=UserPreviewListView, Path=ActualWidth}" Height="200"
                                     Loaded="UserPrevItem_OnLoaded"
                                     MouseLeftButtonDown="UserPrevItem_OnMouseLeftButtonDown">
                    <materialDesign:Card.Triggers>
                        <EventTrigger RoutedEvent="materialDesign:Card.MouseLeftButtonDown">
                            <BeginStoryboard>
                                <Storyboard Target="{Binding ElementName=UserBrowserPageScrollViewer}"
                                            TargetProperty="(ScrollViewer.Opacity)">
                                    <DoubleAnimation From="0" To="1" Duration="00:00:00.3"
                                                     EasingFunction="{StaticResource CubicEase}" />
                                </Storyboard>
                            </BeginStoryboard>
                            <BeginStoryboard>
                                <Storyboard Target="{Binding ElementName=UserBrowserPageScrollViewer}"
                                            TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleX)">
                                    <DoubleAnimation From="0" To="1" Duration="00:00:00.3"
                                                     EasingFunction="{StaticResource CubicEase}" />
                                </Storyboard>
                            </BeginStoryboard>
                            <BeginStoryboard>
                                <Storyboard Target="{Binding ElementName=UserBrowserPageScrollViewer}"
                                            TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleY)">
                                    <DoubleAnimation From="0" To="1" Duration="00:00:00.3"
                                                     EasingFunction="{StaticResource CubicEase}" />
                                </Storyboard>
                            </BeginStoryboard>
                            <BeginStoryboard>
                                <Storyboard Target="{Binding ElementName=ContentContainer}"
                                            TargetProperty="(Grid.Opacity)">
                                    <DoubleAnimation From="1" To="0" Duration="00:00:00.3"
                                                     EasingFunction="{StaticResource CubicEase}" />
                                </Storyboard>
                            </BeginStoryboard>
                            <BeginStoryboard>
                                <Storyboard Target="{Binding ElementName=ContentContainer}"
                                            TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleX)">
                                    <DoubleAnimation From="1" To="0" Duration="00:00:00.3"
                                                     EasingFunction="{StaticResource CubicEase}" />
                                </Storyboard>
                            </BeginStoryboard>
                            <BeginStoryboard>
                                <Storyboard Target="{Binding ElementName=ContentContainer}"
                                            TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleY)">
                                    <DoubleAnimation From="1" To="0" Duration="00:00:00.3"
                                                     EasingFunction="{StaticResource CubicEase}" />
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </materialDesign:Card.Triggers>
                    <materialDesign:Card.Resources>
                        <valueConverters:UserIdConverter x:Key="UserIdConverter" />
                    </materialDesign:Card.Resources>
                    <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Grid.ZIndex="1">
                            <StackPanel.Background>
                                <LinearGradientBrush StartPoint="0 0" EndPoint="1 0">
                                    <GradientStop Color="#FAFAFC" Offset="0" />
                                    <GradientStop Color="#FAFAFC" Offset="0.85" />
                                    <GradientStop Color="Transparent" Offset="1" />
                                </LinearGradientBrush>
                            </StackPanel.Background>
                            <Image x:Name="UserAvatar" Width="150" Height="150" Margin="50 0 0 0"
                                   Style="{StaticResource ReleaseImageStyle}"
                                   Stretch="UniformToFill" VerticalAlignment="Center">
                                <Image.Clip>
                                    <EllipseGeometry Center="75 75" RadiusX="75" RadiusY="75" />
                                </Image.Clip>
                            </Image>
                            <StackPanel Orientation="Vertical" Width="300" Margin="20 30 0 30">
                                <TextBlock FontSize="25" Margin="0 20 0 0" Text="{Binding Name}"
                                           TextWrapping="Wrap" />
                                <TextBlock FontSize="20" Margin="15 25 0 0"
                                           Text="{Binding Id, Converter={StaticResource UserIdConverter}}" />
                            </StackPanel>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Stretch" HorizontalAlignment="Right"
                                    Width="540" Margin="0 0 50 0" Grid.ZIndex="0">
                            <Image x:Name="UserPrevImage1" Height="180" Width="150" Stretch="UniformToFill"
                                   Style="{StaticResource ReleaseImageStyle}"
                                   Margin="10 0" />
                            <Image x:Name="UserPrevImage2" Height="180" Width="150" Stretch="UniformToFill"
                                   Style="{StaticResource ReleaseImageStyle}"
                                   Margin="10 0" />
                            <Image x:Name="UserPrevImage3" Height="180" Width="150" Stretch="UniformToFill"
                                   Style="{StaticResource ReleaseImageStyle}"
                                   Margin="10 0" />
                        </StackPanel>
                    </Grid>
                </materialDesign:Card>
            </materialDesign:TransitioningContent>
        </DataTemplate>
    </Window.Resources>
    <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
        <Grid x:Name="ContentContainer" VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
            <Grid.RenderTransform>
                <ScaleTransform ScaleX="1" ScaleY="1"
                                CenterX="{Binding ElementName=ContentContainer, Path=ActualWidth, Converter={StaticResource ControlCenterConverter}}"
                                CenterY="{Binding ElementName=ContentContainer, Path=ActualHeight, Converter={StaticResource ControlCenterConverter}}" />
            </Grid.RenderTransform>
            <Grid x:Name="NavigatorContainer" VerticalAlignment="Stretch" HorizontalAlignment="Left" Width="250">
                <materialDesign:Card VerticalAlignment="Stretch" HorizontalAlignment="Left" Width="250"
                                     x:Name="NavigatorCard">
                    <Grid>
                        <StackPanel x:Name="NavigatorWrapper" Margin="0 0 0 60">
                            <Grid x:Name="UserInformation" Margin="0 40 0 0">
                                <Image x:Name="UserAvatar" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                    <Image.Style>
                                        <Style TargetType="Image">
                                            <Setter Property="Width" Value="120" />
                                            <Setter Property="Height" Value="120" />
                                            <Style.Triggers>
                                                <DataTrigger
                                                    Binding="{Binding ElementName=ExpandToggleButton, Path=IsChecked}"
                                                    Value="False">
                                                    <Setter Property="RenderTransform">
                                                        <Setter.Value>
                                                            <RotateTransform CenterX="35" CenterY="35" Angle="0" />
                                                        </Setter.Value>
                                                    </Setter>
                                                </DataTrigger>
                                                <DataTrigger
                                                    Binding="{Binding ElementName=ExpandToggleButton, Path=IsChecked}"
                                                    Value="True">
                                                    <Setter Property="RenderTransform">
                                                        <Setter.Value>
                                                            <RotateTransform CenterX="60" CenterY="60" Angle="0" />
                                                        </Setter.Value>
                                                    </Setter>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Image.Style>
                                    <Image.Triggers>
                                        <EventTrigger RoutedEvent="Mouse.MouseEnter">
                                            <BeginStoryboard>
                                                <Storyboard TargetName="UserAvatar"
                                                            TargetProperty="(Image.RenderTransform).(RotateTransform.Angle)">
                                                    <DoubleAnimation x:Name="UserAvatarPositiveRotationAnimation"
                                                                     From="0"
                                                                     To="360" Duration="00:00:01"
                                                                     EasingFunction="{StaticResource CubicEase}" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </EventTrigger>
                                        <EventTrigger RoutedEvent="Mouse.MouseLeave">
                                            <BeginStoryboard>
                                                <Storyboard TargetName="UserAvatar"
                                                            TargetProperty="(Image.RenderTransform).(RotateTransform.Angle)">
                                                    <DoubleAnimation x:Name="UserAvatarNegativeRotationAnimation"
                                                                     From="360" To="0" Duration="00:00:01"
                                                                     EasingFunction="{StaticResource CubicEase}" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </EventTrigger>
                                    </Image.Triggers>
                                    <Image.Clip>
                                        <EllipseGeometry x:Name="AvatarEllipseGeometry" RadiusX="60" RadiusY="60"
                                                         Center="60 60" />
                                    </Image.Clip>
                                </Image>
                                <TextBlock x:Name="UserName" Margin="5 125 5 0" Height="60" FontSize="18"
                                           TextAlignment="Center" VerticalAlignment="Center" TextWrapping="NoWrap" />
                            </Grid>
                            <StackPanel VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                                <ListView Style="{DynamicResource MaterialDesignListView}" x:Name="NavigatorList"
                                          ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                          SelectionChanged="NavigatorList_OnSelectionChanged">
                                    <ListViewItem Height="60" x:Name="MenuTab">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock FontSize="25" Margin="20 0 0 0"
                                                       TextElement.FontFamily="/Resources/#iconfont" Text="&#xe608;"
                                                       VerticalAlignment="Center" />
                                            <Label Margin="30 0 0 0" FontSize="15" FontWeight="Bold"
                                                   Content="主          页"
                                                   VerticalContentAlignment="Center"
                                                   HorizontalContentAlignment="Center" />
                                        </StackPanel>
                                    </ListViewItem>
                                    <ListViewItem Height="60" x:Name="GalleryTab" Selected="GalleryTab_OnSelected">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock FontSize="25" Margin="20 0 0 0"
                                                       TextElement.FontFamily="/Resources/#iconfont" Text="&#xe628;"
                                                       VerticalAlignment="Center" />
                                            <Label Margin="30 0 0 0" FontSize="15" FontWeight="Bold" Content="我 的 收 藏"
                                                   VerticalContentAlignment="Center"
                                                   HorizontalContentAlignment="Center" />
                                        </StackPanel>
                                    </ListViewItem>
                                    <ListViewItem Height="60" x:Name="FollowingTab" Selected="FollowingTab_OnSelected"
                                                  Unselected="FollowingTab_OnUnselected">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock FontSize="25" Margin="20 0 0 0"
                                                       TextElement.FontFamily="/Resources/#iconfont" Text="&#xe604;"
                                                       VerticalAlignment="Center" />
                                            <Label Margin="30 0 0 0" FontSize="15" FontWeight="Bold" Content="我 的 关 注"
                                                   VerticalContentAlignment="Center"
                                                   HorizontalContentAlignment="Center" />
                                        </StackPanel>
                                    </ListViewItem>
                                    <ListViewItem Height="60" x:Name="SpotlightTab" Selected="SpotlightTab_OnSelected">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock FontSize="25" Margin="20 0 0 0"
                                                       TextElement.FontFamily="/Resources/#iconfont" Text="&#xe659;"
                                                       VerticalAlignment="Center" />
                                            <Label Margin="30 0 0 0" FontSize="15" FontWeight="Bold"
                                                   Content="特          辑"
                                                   VerticalContentAlignment="Center"
                                                   HorizontalContentAlignment="Center" />
                                        </StackPanel>
                                    </ListViewItem>
                                    <ListViewItem Height="60" x:Name="RankingTab" Selected="RankingTab_OnSelected">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock FontSize="25" Margin="20 0 0 0"
                                                       TextElement.FontFamily="/Resources/#iconfont" Text="&#xe6ad;"
                                                       VerticalAlignment="Center" />
                                            <Label Margin="30 0 0 0" FontSize="15" FontWeight="Bold" Content="每 日 推 荐"
                                                   VerticalContentAlignment="Center"
                                                   HorizontalContentAlignment="Center" />
                                        </StackPanel>
                                    </ListViewItem>
                                    <ListViewItem Height="60" x:Name="UpdateIllustTab"
                                                  Selected="UpdateIllustTab_OnSelected">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock FontSize="25" Margin="20 0 0 0"
                                                       TextElement.FontFamily="/Resources/#iconfont" Text="&#xe60d;"
                                                       VerticalAlignment="Center" />
                                            <Label Margin="30 0 0 0" FontSize="15" FontWeight="Bold" Content="用 户 新 作"
                                                   VerticalContentAlignment="Center"
                                                   HorizontalContentAlignment="Center" />
                                        </StackPanel>
                                    </ListViewItem>
                                </ListView>
                                <Separator x:Name="Separator" Width="230" Margin="10 10 0 10" Height="1"
                                           HorizontalAlignment="Left" VerticalAlignment="Top" />
                                <ListView Style="{DynamicResource MaterialDesignListView}"
                                          x:Name="ExternalNavigatorList"
                                          ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                    <ListViewItem Height="60" HorizontalAlignment="Stretch" x:Name="DownloadListTab">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock FontSize="25" Margin="20 0 0 0"
                                                       TextElement.FontFamily="/Resources/#iconfont" Text="&#xe64b;"
                                                       VerticalAlignment="Center" />
                                            <Label Margin="30 0 0 0" FontSize="15" FontWeight="Bold" Content="下 载 列 表"
                                                   VerticalContentAlignment="Center"
                                                   HorizontalContentAlignment="Center" />
                                        </StackPanel>
                                    </ListViewItem>
                                    <ListViewItem Height="60" HorizontalAlignment="Stretch" x:Name="SettingsTab"
                                                  Selected="SettingsTab_OnSelected">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock FontSize="25" Margin="20 0 0 0"
                                                       TextElement.FontFamily="/Resources/#iconfont" Text="&#xe643;"
                                                       VerticalAlignment="Center" />
                                            <Label Margin="30 0 0 0" FontSize="15" FontWeight="Bold"
                                                   Content="设          置"
                                                   VerticalContentAlignment="Center"
                                                   HorizontalContentAlignment="Center" />
                                        </StackPanel>
                                    </ListViewItem>
                                    <ListViewItem Height="60" HorizontalAlignment="Stretch" x:Name="SignOutTab"
                                                  Selected="SignOutTab_OnSelected">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock FontSize="25" Margin="20 0 0 0"
                                                       TextElement.FontFamily="/Resources/#iconfont" Text="&#xe6ce;"
                                                       VerticalAlignment="Center" />
                                            <Label Margin="30 0 0 0" FontSize="15" FontWeight="Bold"
                                                   Content="登          出"
                                                   VerticalContentAlignment="Center"
                                                   HorizontalContentAlignment="Center" />
                                        </StackPanel>
                                    </ListViewItem>
                                </ListView>
                            </StackPanel>
                        </StackPanel>
                        <ToggleButton x:Name="ExpandToggleButton" ToolTip="折叠侧边栏" VerticalAlignment="Bottom"
                                      Style="{DynamicResource MaterialDesignHamburgerToggleButton}" Height="25"
                                      Width="25"
                                      HorizontalAlignment="Left" Margin="30 0 0 23" Foreground="Gray" IsChecked="True">
                            <ToggleButton.Triggers>
                                <EventTrigger RoutedEvent="ToggleButton.Unchecked">
                                    <BeginStoryboard>
                                        <Storyboard TargetName="ContentDisplay" TargetProperty="(Grid.Margin)">
                                            <ThicknessAnimation EasingFunction="{StaticResource CubicEase}"
                                                                From="250 0 0 0" To="90 0 0 0" Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="NavigatorCard"
                                                    TargetProperty="(materialDesign:Card.Width)">
                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}" From="250"
                                                             To="90"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="NavigatorContainer" TargetProperty="(Grid.Width)">
                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}" From="250"
                                                             To="90"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="Separator" TargetProperty="(Separator.Width)">
                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}" From="230"
                                                             To="70"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="UserAvatar" TargetProperty="(Image.Width)">
                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}" From="120"
                                                             To="70"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="AvatarEllipseGeometry"
                                                    TargetProperty="(EllipseGeometry.RadiusX)">
                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}" From="60"
                                                             To="35"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="AvatarEllipseGeometry"
                                                    TargetProperty="(EllipseGeometry.RadiusY)">
                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}" From="60"
                                                             To="35"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="AvatarEllipseGeometry"
                                                    TargetProperty="(EllipseGeometry.Center)">
                                            <PointAnimation EasingFunction="{StaticResource CubicEase}" From="60 60"
                                                            To="35 35" Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="UserName" TargetProperty="(TextBlock.Opacity)">
                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}" From="1"
                                                             To="0"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="UserName" TargetProperty="(TextBlock.Margin)">
                                            <ThicknessAnimation EasingFunction="{StaticResource CubicEase}"
                                                                From="5 125 5 0" To="5 35 5 0" Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                                <EventTrigger RoutedEvent="ToggleButton.Checked">
                                    <BeginStoryboard>
                                        <Storyboard TargetName="ContentDisplay" TargetProperty="(Grid.Margin)">
                                            <ThicknessAnimation EasingFunction="{StaticResource CubicEase}"
                                                                From="90 0 0 0"
                                                                To="250 0 0 0" Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="NavigatorCard"
                                                    TargetProperty="(materialDesign:Card.Width)">
                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}" From="90"
                                                             To="250"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="NavigatorContainer" TargetProperty="(Grid.Width)">
                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}" From="90"
                                                             To="250"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="Separator" TargetProperty="(Separator.Width)">
                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}" From="70"
                                                             To="230"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="UserAvatar" TargetProperty="(Image.Width)">
                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}" From="70"
                                                             To="120"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="AvatarEllipseGeometry"
                                                    TargetProperty="(EllipseGeometry.RadiusX)">
                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}" From="35"
                                                             To="60"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="AvatarEllipseGeometry"
                                                    TargetProperty="(EllipseGeometry.RadiusY)">
                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}" From="35"
                                                             To="60"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="AvatarEllipseGeometry"
                                                    TargetProperty="(EllipseGeometry.Center)">
                                            <PointAnimation EasingFunction="{StaticResource CubicEase}" From="35 35"
                                                            To=" 60 60" Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="UserName" TargetProperty="(TextBlock.Opacity)">
                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}" From="0"
                                                             To="1"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="UserName" TargetProperty="(TextBlock.Margin)">
                                            <ThicknessAnimation EasingFunction="{StaticResource CubicEase}"
                                                                From="5 35 5 0"
                                                                To="5 125 5 0" Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </ToggleButton.Triggers>
                        </ToggleButton>
                    </Grid>
                </materialDesign:Card>
            </Grid>
            <Grid x:Name="ContentDisplay" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="250 0 0 0">
                <Grid x:Name="HomeDisplayContainer" Background="#FAFAFC" ZIndex="1">
                    <Grid.Resources>
                        <Storyboard x:Key="MoveUpAnimation"
                                    TargetProperty="(Grid.RenderTransform).(TranslateTransform.Y)"
                                    TargetName="HomeDisplayContainer">
                            <DoubleAnimation From="{Binding ElementName=ContentDisplay, Path=ActualHeight}" To="0"
                                             EasingFunction="{StaticResource CubicEase}" Duration="00:00:00.3" />
                        </Storyboard>
                        <Storyboard x:Key="MoveDownAnimation"
                                    TargetProperty="(Grid.RenderTransform).(TranslateTransform.Y)"
                                    TargetName="HomeDisplayContainer">
                            <DoubleAnimation From="0" To="5000" EasingFunction="{StaticResource CubicEase}"
                                             Duration="00:00:01.50" />
                        </Storyboard>
                    </Grid.Resources>
                    <Grid.RenderTransform>
                        <TranslateTransform Y="0" />
                    </Grid.RenderTransform>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="2*" />
                    </Grid.RowDefinitions>
                    <Image Grid.Row="0" Width="100" Height="100" VerticalAlignment="Bottom" Margin="0 0 0 20"
                           Source="/Resources/pxlogo_large.png">
                        <Image.Triggers>
                            <EventTrigger RoutedEvent="Mouse.MouseEnter">
                                <BeginStoryboard>
                                    <Storyboard TargetName="PixivLogoTransform"
                                                TargetProperty="(RotateTransform.Angle)">
                                        <DoubleAnimation From="0" To="360" Duration="00:00:01"
                                                         EasingFunction="{StaticResource CubicEase}" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                            <EventTrigger RoutedEvent="Mouse.MouseLeave">
                                <BeginStoryboard>
                                    <Storyboard TargetName="PixivLogoTransform"
                                                TargetProperty="(RotateTransform.Angle)">
                                        <DoubleAnimation From="360" To="0" Duration="00:00:01"
                                                         EasingFunction="{StaticResource CubicEase}" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </Image.Triggers>
                        <Image.RenderTransform>
                            <RotateTransform x:Name="PixivLogoTransform" CenterX="50" CenterY="50" Angle="0" />
                        </Image.RenderTransform>
                        <Image.Clip>
                            <EllipseGeometry RadiusX="50" RadiusY="50" Center="50 50" />
                        </Image.Clip>
                    </Image>
                    <StackPanel Grid.Row="1" Height="50" Margin="0 20 0 0" HorizontalAlignment="Center"
                                VerticalAlignment="Top" Orientation="Horizontal">
                        <TextBox x:Name="KeywordTextBox" Width="800" GotFocus="KeywordTextBox_OnGotFocus"
                                 PreviewKeyDown="KeywordTextBox_OnPreviewKeyDown"
                                 Style="{DynamicResource MaterialDesignFloatingHintTextBox}"
                                 TextChanged="KeywordTextBox_OnTextChanged"
                                 materialDesign:HintAssist.Hint="请输入要搜索的内容~(￣▽￣)~*" />
                        <TextBox Width="0" Height="0" x:Name="ToLoseFocus" />
                        <Button x:Name="DoQueryButton" IsDefault="False" Margin="10 15 0 0" Width="50" Height="40"
                                Style="{DynamicResource MaterialDesignToolButton}" Click="DoQueryButton_OnClick">
                            <Viewbox Width="34" Height="30">
                                <Canvas Width="24" Height="24">
                                    <Path
                                        Data="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"
                                        Fill="Black" Opacity="0.6" />
                                </Canvas>
                            </Viewbox>
                        </Button>
                    </StackPanel>
                    <Popup x:Name="AutoCompletionPopup" Grid.Row="1" Width="800" StaysOpen="False"
                           AllowsTransparency="True"
                           PopupAnimation="Fade" PlacementTarget="{Binding ElementName=KeywordTextBox}"
                           Placement="Bottom">
                        <materialDesign:Card Width="800" Background="#FAFAFC">
                            <ListBox x:Name="AutoCompletionListBox" Width="800" MaxHeight="400"
                                     ScrollViewer.CanContentScroll="False">
                                <ListBox.ItemTemplate>
                                    <DataTemplate DataType="viewModel:AutoCompletion">
                                        <ListBoxItem HorizontalAlignment="Stretch" x:Name="AutoCompletionElement"
                                                     Width="{Binding ElementName=AutoCompletionListBox, Path=Width}"
                                                     PreviewMouseLeftButtonDown="AutoCompletionElement_OnPreviewMouseLeftButtonDown">
                                            <StackPanel HorizontalAlignment="Stretch">
                                                <TextBlock FontSize="12" HorizontalAlignment="Left"
                                                           Text="{Binding Tag}"
                                                           Margin="0 0 0 5" TextWrapping="NoWrap"
                                                           TextTrimming="WordEllipsis" />
                                                <TextBlock FontSize="10" HorizontalAlignment="Left"
                                                           Text="{Binding TranslatedName}" TextWrapping="NoWrap"
                                                           TextTrimming="WordEllipsis" />
                                            </StackPanel>
                                        </ListBoxItem>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </materialDesign:Card>
                    </Popup>
                    <Popup StaysOpen="True" x:Name="QueryOptionPopup" PopupAnimation="Fade" AllowsTransparency="True"
                           HorizontalOffset="350"
                           objects:PopupHelper.PopupPlacementTarget="{Binding ElementName=KeywordTextBox}" Grid.Row="1"
                           Placement="Bottom" PlacementTarget="{Binding ElementName=KeywordTextBox}">
                        <StackPanel Height="40" Background="#FAFAFC" Orientation="Horizontal">
                            <ToggleButton x:Name="QueryArtistToggleButton" ToolTip="搜索用户" Width="30" Height="30"
                                          Style="{DynamicResource MaterialDesignFlatToggleButton}" Margin="0 0 5 0"
                                          Checked="QueryArtistToggleButton_OnChecked"
                                          Unchecked="QueryArtistToggleButton_OnUnchecked">
                                <Viewbox Width="24" Height="24">
                                    <Canvas Width="24" Height="24">
                                        <Path
                                            Data="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"
                                            Fill="Gray" />
                                    </Canvas>
                                </Viewbox>
                            </ToggleButton>
                            <ToggleButton x:Name="QuerySingleArtistToggleButton" ToolTip="搜索单个用户" Width="30"
                                          Height="30"
                                          Style="{DynamicResource MaterialDesignFlatToggleButton}" Margin="5 0 5 0"
                                          Checked="QuerySingleArtistToggleButton_OnChecked">
                                <Viewbox Width="24" Height="24">
                                    <Canvas Width="24" Height="24">
                                        <Path
                                            Data="M19,21V19H15V17H19V15L22,18L19,21M10,4A4,4 0 0,1 14,8A4,4 0 0,1 10,12A4,4 0 0,1 6,8A4,4 0 0,1 10,4M10,14C11.15,14 12.25,14.12 13.24,14.34C12.46,15.35 12,16.62 12,18C12,18.7 12.12,19.37 12.34,20H2V18C2,15.79 5.58,14 10,14Z"
                                            Fill="Gray" />
                                    </Canvas>
                                </Viewbox>
                            </ToggleButton>
                            <ToggleButton x:Name="QuerySingleWorkToggleButton" ToolTip="搜索单个作品" Width="30" Height="30"
                                          Style="{DynamicResource MaterialDesignFlatToggleButton}" Margin="5 0 0 0"
                                          Checked="QuerySingleWorkToggleButton_OnChecked">
                                <Viewbox Width="24" Height="24">
                                    <Canvas Width="24" Height="24">
                                        <Path
                                            Data="M10,7V9H12V17H14V7H10M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2Z"
                                            Fill="Gray" />
                                    </Canvas>
                                </Viewbox>
                            </ToggleButton>
                        </StackPanel>
                    </Popup>
                </Grid>
                <Grid x:Name="QueryDisplayContainer" Background="#FAFAFC">
                    <ListView x:Name="SpotlightListView" VirtualizingPanel.CacheLengthUnit="Pixel"
                              VirtualizingPanel.CacheLength="0 0" VirtualizingPanel.ScrollUnit="Pixel"
                              VirtualizingPanel.VirtualizationMode="Standard"
                              ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                              Visibility="{Binding ElementName=SpotlightTab, Path=IsSelected, Converter={StaticResource VisibleIfTrueConverter}}"
                              ItemTemplate="{StaticResource SpotlightDataTemplate}">
                        <ListView.Style>
                            <Style BasedOn="{StaticResource MaterialDesignListView}" TargetType="ListView">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ElementName=SpotlightTab, Path=IsSelected}"
                                                 Value="False">
                                        <Setter Property="ItemsSource" Value="{x:Null}" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListView.Style>
                        <ListView.Template>
                            <ControlTemplate>
                                <ScrollViewer VirtualizingStackPanel.IsVirtualizing="True"
                                              VirtualizingStackPanel.VirtualizationMode="Recycling">
                                    <ItemsPresenter />
                                </ScrollViewer>
                            </ControlTemplate>
                        </ListView.Template>
                        <ListView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <VirtualizingStackPanel />
                            </ItemsPanelTemplate>
                        </ListView.ItemsPanel>
                    </ListView>
                    <ListView x:Name="UserPreviewListView" VirtualizingPanel.CacheLengthUnit="Pixel"
                              VirtualizingPanel.CacheLength="0 0" VirtualizingPanel.ScrollUnit="Pixel"
                              VirtualizingPanel.VirtualizationMode="Standard"
                              ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                              ItemTemplate="{StaticResource UserPreviewTemplate}">
                        <ListView.Resources>
                            <valueConverters:UserPreviewListViewVisibilityConverter
                                x:Key="UserPreviewListViewVisibilityConverter" />
                        </ListView.Resources>
                        <ListView.Visibility>
                            <MultiBinding Converter="{StaticResource UserPreviewListViewVisibilityConverter}">
                                <Binding ElementName="SpotlightTab" Path="IsSelected" />
                                <Binding ElementName="QueryArtistToggleButton" Path="IsChecked" />
                            </MultiBinding>
                        </ListView.Visibility>
                        <ListView.Template>
                            <ControlTemplate>
                                <ScrollViewer VirtualizingStackPanel.IsVirtualizing="True"
                                              VirtualizingStackPanel.VirtualizationMode="Recycling">
                                    <ItemsPresenter />
                                </ScrollViewer>
                            </ControlTemplate>
                        </ListView.Template>
                        <ListView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <VirtualizingStackPanel />
                            </ItemsPanelTemplate>
                        </ListView.ItemsPanel>
                    </ListView>
                    <ListView x:Name="ImageListView" VirtualizingPanel.CacheLengthUnit="Pixel" Grid.ZIndex="1"
                              VirtualizingPanel.CacheLength="0 0" VirtualizingPanel.ScrollUnit="Pixel"
                              VirtualizingPanel.VirtualizationMode="Standard"
                              Width="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Grid}, AncestorLevel=1}}"
                              ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                              ItemTemplate="{StaticResource IllustrationTemplate}">
                        <ListView.Style>
                            <Style TargetType="ListView" BasedOn="{StaticResource MaterialDesignListView}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ElementName=MenuTab, Path=IsSelected}" Value="True">
                                        <Setter Property="ItemsSource" Value="{x:Null}" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListView.Style>
                        <ListView.Resources>
                            <valueConverters:ImageListViewVisibilityConverter x:Key="ImageListViewVisibilityConverter" />
                        </ListView.Resources>
                        <ListView.Visibility>
                            <MultiBinding Converter="{StaticResource ImageListViewVisibilityConverter}">
                                <Binding ElementName="SpotlightTab" Path="IsSelected" />
                                <Binding ElementName="FollowingTab" Path="IsSelected" />
                                <Binding ElementName="QueryArtistToggleButton" Path="IsChecked" />
                            </MultiBinding>
                        </ListView.Visibility>
                        <ListView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <controls:VirtualizingWrapPanel Orientation="Vertical" />
                            </ItemsPanelTemplate>
                        </ListView.ItemsPanel>
                    </ListView>
                </Grid>
            </Grid>
            <Grid x:Name="DownloadListGrid" HorizontalAlignment="Right" VerticalAlignment="Stretch" Width="300">
                <Grid.Style>
                    <Style>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ElementName=DownloadListTab, Path=IsSelected}" Value="True">
                                <DataTrigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)">
                                            <DoubleAnimation From="300" To="0"
                                                             EasingFunction="{StaticResource CubicEase}"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </DataTrigger.EnterActions>
                                <DataTrigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)">
                                            <DoubleAnimation From="0" To="300"
                                                             EasingFunction="{StaticResource CubicEase}"
                                                             Duration="00:00:00.3" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </DataTrigger.ExitActions>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Style>
                <materialDesign:Card VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                    <Grid>
                        <Grid Height="60" VerticalAlignment="Top">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Button Grid.Column="0" Style="{DynamicResource MaterialDesignToolButton}" Height="40"
                                    Width="40"
                                    x:Name="DownloadAllButton" Margin="20 0 0 0" Click="DownloadAllButton_OnClick">
                                <Viewbox Width="30" Height="30">
                                    <Canvas Width="24" Height="24">
                                        <Path Data="M9,1V7H5L12,14L19,7H15V1H9M5,16V18H19V16H5M5,20V22H19V20H5Z"
                                              Fill="Gray" />
                                    </Canvas>
                                </Viewbox>
                            </Button>
                            <Button x:Name="ClearDownloadListButton" Click="ClearDownloadListButton_OnClick"
                                    Grid.Column="1" Style="{DynamicResource MaterialDesignToolButton}" Height="40"
                                    Width="40">
                                <Viewbox Width="30" Height="30">
                                    <Canvas Width="24" Height="24">
                                        <Path
                                            Data="M15,16H19V18H15V16M15,8H22V10H15V8M15,12H21V14H15V12M3,18A2,2 0 0,0 5,20H11A2,2 0 0,0 13,18V8H3V18M14,5H11L10,4H6L5,5H2V7H14V5Z"
                                            Fill="Gray" />
                                    </Canvas>
                                </Viewbox>
                            </Button>
                            <Button x:Name="RetractDownloadListButton" Grid.Column="2"
                                    Style="{DynamicResource MaterialDesignToolButton}" Height="40" Width="40"
                                    Margin="0 0 20 0"
                                    Click="RetractDownloadListButton_OnClick">
                                <Viewbox Width="30" Height="30">
                                    <Canvas Width="24" Height="24">
                                        <Path
                                            Data="M19,3H16.3H7.7H5A2,2 0 0,0 3,5V7.7V16.4V19A2,2 0 0,0 5,21H7.7H16.4H19A2,2 0 0,0 21,19V16.3V7.7V5A2,2 0 0,0 19,3M15.6,17L12,13.4L8.4,17L7,15.6L10.6,12L7,8.4L8.4,7L12,10.6L15.6,7L17,8.4L13.4,12L17,15.6L15.6,17Z"
                                            Fill="Gray" />
                                    </Canvas>
                                </Viewbox>
                            </Button>
                        </Grid>
                        <ListView x:Name="ToDownloadListView" Margin="0 80 0 0"
                                  ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                            <ListView.ItemTemplate>
                                <DataTemplate DataType="viewModel:Illustration">
                                    <ListViewItem x:Name="ToDownloadListViewItem"
                                                  MouseDoubleClick="ToDownloadListViewItem_OnMouseDoubleClick">
                                        <Grid Cursor="Hand" Width="290">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="3*" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock VerticalAlignment="Center" Grid.Column="0"
                                                       HorizontalAlignment="Left" Margin="10 0 0 0" FontSize="20"
                                                       TextWrapping="NoWrap" TextTrimming="WordEllipsis"
                                                       FontFamily="Microsoft YaHei UI Light">
                                                <TextBlock.Text>
                                                    <MultiBinding StringFormat="{}作品ID: {0}">
                                                        <Binding Path="Id" />
                                                    </MultiBinding>
                                                </TextBlock.Text>
                                            </TextBlock>
                                            <Button x:Name="DownloadSingleFromDownloadListButton"
                                                    Click="DownloadSingleFromDownloadListButton_OnClick"
                                                    Grid.Column="1"
                                                    Style="{DynamicResource MaterialDesignToolButton}"
                                                    HorizontalAlignment="Right">
                                                <Viewbox Width="24" Height="24">
                                                    <Canvas Width="24" Height="24">
                                                        <Path Data="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"
                                                              Fill="Gray" />
                                                    </Canvas>
                                                </Viewbox>
                                            </Button>
                                            <Button x:Name="RemoveFromDownloadListButton" Grid.Column="2"
                                                    Style="{DynamicResource MaterialDesignToolButton}"
                                                    HorizontalAlignment="Center"
                                                    Click="RemoveFromDownloadButton_OnClick">
                                                <Viewbox Width="24" Height="24">
                                                    <Canvas Width="24" Height="24">
                                                        <Path
                                                            Data="M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z"
                                                            Fill="Gray" />
                                                    </Canvas>
                                                </Viewbox>
                                            </Button>
                                        </Grid>
                                    </ListViewItem>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem" BasedOn="{StaticResource MaterialDesignListBoxItem}">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                </Style>
                            </ListView.ItemContainerStyle>
                        </ListView>
                    </Grid>
                </materialDesign:Card>
                <Grid.RenderTransform>
                    <TranslateTransform x:Name="DownloadListTranslateTransform" X="300" />
                </Grid.RenderTransform>
            </Grid>
        </Grid>
        <ScrollViewer x:Name="UserBrowserPageScrollViewer" HorizontalScrollBarVisibility="Disabled">
            <ScrollViewer.RenderTransform>
                <ScaleTransform ScaleX="0" ScaleY="0"
                                CenterX="{Binding ElementName=UserBrowserPageScrollViewer, Path=ActualWidth, Converter={StaticResource ControlCenterConverter}}"
                                CenterY="{Binding ElementName=UserBrowserPageScrollViewer, Path=ActualHeight, Converter={StaticResource ControlCenterConverter}}" />
            </ScrollViewer.RenderTransform>
            <ScrollViewer.Resources>
                <system:Double x:Key="{x:Static SystemParameters.VerticalScrollBarWidthKey}">10</system:Double>
                <Storyboard x:Key="CheckerIncreaseWidthAnimation" TargetProperty="(Grid.Width)"
                            TargetName="CheckerSnackBar">
                    <DoubleAnimation From="90" To="180" Duration="00:00:00.3"
                                     EasingFunction="{StaticResource CubicEase}" />
                </Storyboard>
                <Storyboard x:Key="CheckerDecreaseWidthAnimation" TargetProperty="(Grid.Width)"
                            TargetName="CheckerSnackBar">
                    <DoubleAnimation From="180" To="90" Duration="00:00:00.3"
                                     EasingFunction="{StaticResource CubicEase}" />
                </Storyboard>
                <Storyboard x:Key="CheckerOpacityMaskIncreaseWidthAnimation" TargetProperty="(Grid.Width)"
                            TargetName="CheckerSnackBarOpacityMask">
                    <DoubleAnimation From="90" To="180" Duration="00:00:00.3"
                                     EasingFunction="{StaticResource CubicEase}" />
                </Storyboard>
                <Storyboard x:Key="CheckerOpacityMaskDecreaseWidthAnimation" TargetProperty="(Grid.Width)"
                            TargetName="CheckerSnackBarOpacityMask">
                    <DoubleAnimation From="180" To="90" Duration="00:00:00.3"
                                     EasingFunction="{StaticResource CubicEase}" />
                </Storyboard>
            </ScrollViewer.Resources>
            <StackPanel Background="#FAFAFC" d:DataContext="{d:DesignData User}">
                <Grid HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="300">
                    <Image x:Name="UserBanner" HorizontalAlignment="Stretch" VerticalAlignment="Center"
                           Stretch="UniformToFill" />
                </Grid>
                <Grid HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="150">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid Grid.Column="0" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="20 20 0 0">
                        <TextBlock x:Name="BackToMainPageButton"
                                   MouseLeftButtonDown="BackToMainPageButton_OnMouseLeftButtonDown"
                                   FontFamily="/Resources/#iconfont" Text="&#xe619;" FontSize="30" Cursor="Hand">
                            <TextBlock.Triggers>
                                <EventTrigger RoutedEvent="TextBlock.MouseLeftButtonDown">
                                    <BeginStoryboard>
                                        <Storyboard TargetName="UserBrowserPageScrollViewer"
                                                    TargetProperty="(ScrollViewer.Opacity)">
                                            <DoubleAnimation From="1" To="0" Duration="00:00:00.3"
                                                             EasingFunction="{StaticResource CubicEase}" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="UserBrowserPageScrollViewer"
                                                    TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleX)">
                                            <DoubleAnimation From="1" To="0" Duration="00:00:00.3"
                                                             EasingFunction="{StaticResource CubicEase}" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="UserBrowserPageScrollViewer"
                                                    TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleY)">
                                            <DoubleAnimation From="1" To="0" Duration="00:00:00.3"
                                                             EasingFunction="{StaticResource CubicEase}" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="ContentContainer" TargetProperty="(Grid.Opacity)">
                                            <DoubleAnimation From="0" To="1" Duration="00:00:00.3"
                                                             EasingFunction="{StaticResource CubicEase}" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="ContentContainer"
                                                    TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleX)">
                                            <DoubleAnimation From="0" To="1" Duration="00:00:00.3"
                                                             EasingFunction="{StaticResource CubicEase}" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard TargetName="ContentContainer"
                                                    TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleY)">
                                            <DoubleAnimation From="0" To="1" Duration="00:00:00.3"
                                                             EasingFunction="{StaticResource CubicEase}" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </TextBlock.Triggers>
                        </TextBlock>
                    </Grid>
                    <Grid Width="120" Height="120" Grid.Column="0" HorizontalAlignment="Right" VerticalAlignment="Top"
                          Margin="0 -30 0 0">
                        <Image x:Name="UserBrowserUserAvatar" Stretch="UniformToFill">
                            <Image.Clip>
                                <EllipseGeometry Center="60 60" RadiusX="60" RadiusY="60" />
                            </Image.Clip>
                        </Image>
                        <Ellipse StrokeThickness="2" Stroke="#FAFAFC" />
                    </Grid>
                    <StackPanel Grid.Column="1" Margin="20 0 40 20">
                        <Grid Height="90" VerticalAlignment="Top">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <StackPanel Grid.Row="0" VerticalAlignment="Center" Orientation="Horizontal">
                                <TextBlock FontSize="20" Text="{Binding Name}" />
                                <Border Width="70" VerticalAlignment="Stretch" Margin="10 2 0 2" Background="#FD9E16"
                                        CornerRadius="10"
                                        Visibility="{Binding IsPremium, Converter={StaticResource VisibleIfTrueConverter}}">
                                    <TextBlock HorizontalAlignment="Center" Foreground="White"
                                               VerticalAlignment="Center">
                                        premium
                                    </TextBlock>
                                </Border>
                            </StackPanel>
                            <StackPanel Grid.Row="1" VerticalAlignment="Top" Margin="0 5 0 0" Orientation="Horizontal">
                                <TextBlock VerticalAlignment="Center" FontSize="15" Foreground="#03A9F4"
                                           Text="{Binding Follows}" />
                                <TextBlock VerticalAlignment="Center" FontSize="15" Margin="5 0 0 0">关注</TextBlock>
                                <Button x:Name="ShareUserButton" Width="30" Height="30" Margin="20 0 0 0"
                                        Style="{DynamicResource MaterialDesignToolButton}" Cursor="Hand"
                                        PreviewMouseLeftButtonDown="ShareUserButton_OnPreviewMouseLeftButtonDown">
                                    <TextBlock FontFamily="/Resources/#iconfont" Text="&#xe661;" FontSize="20" />
                                </Button>
                                <Button x:Name="ViewUserInBrowserButton" Width="30" Height="30" Margin="10 0 0 0"
                                        Style="{DynamicResource MaterialDesignToolButton}" Cursor="Hand"
                                        PreviewMouseLeftButtonDown="ViewUserInBrowserButton_OnPreviewMouseLeftButtonDown">
                                    <TextBlock FontFamily="/Resources/#iconfont" Text="&#xe606;" FontSize="20" />
                                </Button>
                            </StackPanel>
                            <Border Grid.Row="0" Grid.RowSpan="2" HorizontalAlignment="Right" Width="120" Height="40"
                                    Background="#66CCFF" CornerRadius="10"
                                    Visibility="{Binding IsFollowed, Converter={StaticResource VisibleIfFalseConverter}}">
                                <Button x:Name="FollowButton" Click="FollowButton_OnClick"
                                        Style="{DynamicResource MaterialDesignToolButton}" Padding="30 0" Width="120"
                                        Height="40">
                                    <TextBlock>关  注</TextBlock>
                                </Button>
                            </Border>
                            <Border Grid.Row="0" Grid.RowSpan="2" HorizontalAlignment="Right" Width="120" Height="40"
                                    Background="#FFCBCBCB" CornerRadius="10"
                                    Visibility="{Binding IsFollowed, Converter={StaticResource VisibleIfTrueConverter}}">
                                <Button x:Name="UnFollowButton" Click="UnFollowButton_OnClick"
                                        Style="{DynamicResource MaterialDesignToolButton}" Padding="30 0" Width="120"
                                        Height="40">
                                    <TextBlock>已  关  注</TextBlock>
                                </Button>
                            </Border>
                        </Grid>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock FontSize="15" Text="{Binding Introduction}" Margin="20 0 0 0" MaxWidth="600"
                                       HorizontalAlignment="Left" TextTrimming="CharacterEllipsis" />
                            <TextBlock x:Name="ViewIntroductionButton" Margin="20 0 0 0"
                                       FontFamily="/Resources/#iconfont" Text="&#xe660;" FontSize="20" Cursor="Hand" />
                        </StackPanel>
                    </StackPanel>
                </Grid>
                <Separator Height="1" />
                <Grid>
                    <Grid Width="180" Height="5" VerticalAlignment="Top">
                        <Grid x:Name="CheckerSnackBar" Width="90" Height="5" Background="#0096FA"
                              HorizontalAlignment="Left" />
                    </Grid>
                    <Grid Width="180" Height="45" Margin="0 5 0 0" VerticalAlignment="Bottom" Background="#FAFAFC">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <TextBlock x:Name="UploadChecker" Grid.Column="0" Text="插 画" Cursor="Hand"
                                   VerticalAlignment="Center" HorizontalAlignment="Center" TextAlignment="Center"
                                   FontSize="20" FontFamily="Microsoft JHengHei UI Light"
                                   MouseLeftButtonDown="UploadChecker_OnMouseLeftButtonDown" />
                        <TextBlock x:Name="GalleryChecker" Grid.Column="1" Text="收 藏" Cursor="Hand"
                                   VerticalAlignment="Center" HorizontalAlignment="Center" TextAlignment="Center"
                                   FontSize="20" FontFamily="Microsoft JHengHei UI Light"
                                   MouseLeftButtonDown="GalleryChecker_OnMouseLeftButtonDown" />
                    </Grid>
                    <Grid Width="180" Height="45" VerticalAlignment="Bottom">
                        <Grid x:Name="CheckerSnackBarOpacityMask" Background="Gray" Opacity="0.2" Width="90"
                              HorizontalAlignment="Left" />
                    </Grid>
                </Grid>
                <Grid Margin="0 20 0 0">
                    <ListView x:Name="UserIllustsImageListView" VirtualizingPanel.CacheLengthUnit="Pixel"
                              Grid.ZIndex="1"
                              VirtualizingPanel.CacheLength="0 0" VirtualizingPanel.ScrollUnit="Pixel"
                              VirtualizingPanel.VirtualizationMode="Standard" HorizontalAlignment="Stretch"
                              ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                              ItemTemplate="{StaticResource IllustrationTemplate}">
                        <ListView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <controls:VirtualizingWrapPanel Orientation="Vertical" />
                            </ItemsPanelTemplate>
                        </ListView.ItemsPanel>
                    </ListView>
                </Grid>
            </StackPanel>
        </ScrollViewer>
        <userControls:PixevalSettingPage x:Name="PixevalSettingPage" />
        <materialDesign:DialogHost x:Name="IllustBrowserDialogHost" CloseOnClickAway="True"
                                   DialogOpened="IllustBrowserDialogHost_OnDialogOpened"
                                   DialogClosing="IllustBrowserDialogHost_OnDialogClosing"
                                   d:DataContext="{d:DesignData Illustration}">
            <materialDesign:DialogHost.DialogContent>
                <materialDesign:Card BorderBrush="#FAFAFC" Background="#FAFAFC">
                    <StackPanel x:Name="IllustBrowserContainer" Background="#FAFAFC" Width="1000">
                        <materialDesign:Card x:Name="Banner" Height="100" StackPanel.ZIndex="1">
                            <Grid Background="#FAFAFC">
                                <Image x:Name="ImageBrowserUserAvatar" HorizontalAlignment="Left" Margin="20 20 0 20"
                                       Width="60" Height="60" Stretch="UniformToFill"
                                       MouseLeftButtonDown="ImageBrowserUserAvatar_OnMouseLeftButtonDown">
                                    <Image.Triggers>
                                        <EventTrigger RoutedEvent="Image.MouseLeftButtonDown">
                                            <BeginStoryboard>
                                                <Storyboard Target="{Binding ElementName=UserBrowserPageScrollViewer}"
                                                            TargetProperty="(ScrollViewer.Opacity)">
                                                    <DoubleAnimation From="0" To="1" Duration="00:00:00.3"
                                                                     EasingFunction="{StaticResource CubicEase}" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                            <BeginStoryboard>
                                                <Storyboard Target="{Binding ElementName=UserBrowserPageScrollViewer}"
                                                            TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleX)">
                                                    <DoubleAnimation From="0" To="1" Duration="00:00:00.3"
                                                                     EasingFunction="{StaticResource CubicEase}" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                            <BeginStoryboard>
                                                <Storyboard Target="{Binding ElementName=UserBrowserPageScrollViewer}"
                                                            TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleY)">
                                                    <DoubleAnimation From="0" To="1" Duration="00:00:00.3"
                                                                     EasingFunction="{StaticResource CubicEase}" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                            <BeginStoryboard>
                                                <Storyboard Target="{Binding ElementName=ContentContainer}"
                                                            TargetProperty="(Grid.Opacity)">
                                                    <DoubleAnimation From="1" To="0" Duration="00:00:00.3"
                                                                     EasingFunction="{StaticResource CubicEase}" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                            <BeginStoryboard>
                                                <Storyboard Target="{Binding ElementName=ContentContainer}"
                                                            TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleX)">
                                                    <DoubleAnimation From="1" To="0" Duration="00:00:00.3"
                                                                     EasingFunction="{StaticResource CubicEase}" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                            <BeginStoryboard>
                                                <Storyboard Target="{Binding ElementName=ContentContainer}"
                                                            TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleY)">
                                                    <DoubleAnimation From="1" To="0" Duration="00:00:00.3"
                                                                     EasingFunction="{StaticResource CubicEase}" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </EventTrigger>
                                    </Image.Triggers>
                                    <Image.Clip>
                                        <EllipseGeometry Center="30 30" RadiusX="30" RadiusY="30" />
                                    </Image.Clip>
                                </Image>
                                <StackPanel Margin="90 20 0 20">
                                    <TextBlock Text="{Binding Title}" Foreground="#03A9F4"
                                               FontFamily="Microsoft YaHei Light" FontSize="15"
                                               Margin="0 5 0 13" />
                                    <StackPanel Orientation="Horizontal">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding UserName}" FontFamily="Microsoft YaHei Light"
                                                       FontSize="12" />
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <TextBlock FontFamily="Microsoft YaHei Light"
                                                       FontSize="12" Margin="50 0 0 0" Text="作品ID: " />
                                            <TextBlock Foreground="#03A9F4" FontFamily="Microsoft YaHei Light"
                                                       FontSize="12" Margin="0 0 30 0" Text="{Binding Id}" />
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <TextBlock FontFamily="Microsoft YaHei Light"
                                                       FontSize="12" Text="总浏览量: " />
                                            <TextBlock Foreground="#03A9F4" FontFamily="Microsoft YaHei Light"
                                                       FontSize="12" Margin="0 0 30 0" Text="{Binding ViewCount}" />
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <TextBlock FontFamily="Microsoft YaHei Light"
                                                       FontSize="12" Text="收藏数: " />
                                            <TextBlock Foreground="#03A9F4" FontFamily="Microsoft YaHei Light"
                                                       FontSize="12" Margin="0 0 30 0" Text="{Binding Bookmark}" />
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <TextBlock FontFamily="Microsoft YaHei Light"
                                                       FontSize="12" Text="分辨率: " />
                                            <TextBlock Foreground="#03A9F4" FontFamily="Microsoft YaHei Light"
                                                       FontSize="12" Margin="0 0 30 0" Text="{Binding Resolution}" />
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </materialDesign:Card>
                        <materialDesign:Card Background="#FAFAFC" MaxHeight="300"
                                             Width="{Binding ElementName=Banner, Path=ActualWidth}"
                                             MaxWidth="{Binding ElementName=Banner, Path=ActualWidth}"
                                             StackPanel.ZIndex="1">
                            <StackPanel>
                                <StackPanel Margin="20" Orientation="Horizontal" FlowDirection="LeftToRight">
                                    <TextBlock FontSize="12" FontFamily="Microsoft YaHei Light" Text="上传日期: " />
                                    <TextBlock Foreground="#03A9F4" FontSize="12" FontFamily="Microsoft YaHei Light"
                                               Text="{Binding PublishDate, Converter={StaticResource DateTimeOffsetConverter}}" />
                                </StackPanel>
                                <TextBlock Margin="20 0 0 0" Text="#作品标签: " FontSize="12"
                                           FontFamily="Microsoft YaHei Light" />
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="2.5*" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <ListView Grid.Column="0" ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                              Margin="20 0 0 20" ItemsSource="{Binding Tags}">
                                        <ListView.ItemTemplate>
                                            <DataTemplate DataType="viewModel:Tag">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock FontSize="10">
                                                        <Hyperlink x:Name="TagNavigateHyperlink"
                                                                   Click="TagNavigateHyperlink_OnClick"
                                                                   Foreground="#03A9F4">
                                                            <TextBlock
                                                                Text="{Binding Name, Converter={StaticResource IllustTagConverter}}" />
                                                        </Hyperlink>
                                                    </TextBlock>
                                                    <TextBlock FontSize="10" Margin="5 0 0 0"
                                                               Text="{Binding TranslatedName}" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                        <ListView.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel />
                                            </ItemsPanelTemplate>
                                        </ListView.ItemsPanel>
                                    </ListView>
                                    <StackPanel Grid.Column="1" HorizontalAlignment="Right" Orientation="Horizontal"
                                                FlowDirection="RightToLeft">
                                        <StackPanel.Resources>
                                            <Style x:Key="TextBlockStyle" TargetType="TextBlock"
                                                   BasedOn="{StaticResource MaterialDesignBody1TextBlock}">
                                                <Setter Property="FontSize" Value="20" />
                                                <Setter Property="Foreground" Value="#03A9F4" />
                                                <Setter Property="FontFamily" Value="/Resources/#iconfont" />
                                                <Setter Property="Cursor" Value="Hand" />
                                                <Setter Property="Height" Value="30" />
                                                <Setter Property="Width" Value="30" />
                                                <Setter Property="Margin" Value="5 0 0 0" />
                                            </Style>
                                        </StackPanel.Resources>
                                        <TextBlock x:Name="ShareButton" Style="{StaticResource TextBlockStyle}"
                                                   Margin="10 0 0 0" Text="&#xe661;"
                                                   MouseLeftButtonDown="ShareButton_OnMouseLeftButtonDown" />
                                        <TextBlock x:Name="AddToDownloadListButton"
                                                   Style="{StaticResource TextBlockStyle}" Text="&#xe62e;"
                                                   MouseLeftButtonDown="AddToDownloadListButton_OnMouseLeftButtonDown" />
                                        <TextBlock x:Name="AddAllToDownloadListButton"
                                                   Style="{StaticResource TextBlockStyle}" Text="&#xe663;"
                                                   MouseLeftButtonDown="AddAllToDownloadListButton_OnMouseLeftButtonDown" />
                                        <TextBlock x:Name="ViewInBrowserButton" Style="{StaticResource TextBlockStyle}"
                                                   Text="&#xe606;"
                                                   MouseLeftButtonDown="ViewInBrowserButton_OnMouseLeftButtonDown" />
                                        <TextBlock x:Name="DownloadButton" Style="{StaticResource TextBlockStyle}"
                                                   Text="&#xe60a;"
                                                   MouseLeftButtonDown="DownloadButton_OnMouseLeftButtonDown" />
                                        <Grid>
                                            <TextBlock
                                                Visibility="{Binding IsLiked, Converter={StaticResource VisibleIfFalseConverter}}"
                                                x:Name="IllustBrowserFavorButton"
                                                Style="{StaticResource TextBlockStyle}"
                                                Text="&#xe63e;"
                                                MouseLeftButtonDown="IllustBrowserFavorButton_OnMouseLeftButtonDown" />
                                            <TextBlock
                                                Visibility="{Binding IsLiked, Converter={StaticResource VisibleIfTrueConverter}}"
                                                x:Name="IllustBrowserDisfavorButton"
                                                Style="{StaticResource TextBlockStyle}"
                                                Text="&#xeb4c;"
                                                MouseLeftButtonDown="IllustBrowserDisfavorButton_OnMouseLeftButtonDown" />
                                        </Grid>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </materialDesign:Card>
                    </StackPanel>
                </materialDesign:Card>
            </materialDesign:DialogHost.DialogContent>
        </materialDesign:DialogHost>
        <materialDesign:Snackbar x:Name="MainWindowSnackBar" HorizontalContentAlignment="Center"
                                 VerticalContentAlignment="Center" HorizontalAlignment="Center" />
    </Grid>
</Window>